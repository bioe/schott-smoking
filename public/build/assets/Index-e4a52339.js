import{r as A,v as B,c,a as m,u as l,w as f,F as v,o as r,X as D,b,t as a,d as t,g as L,e as p,f as g,I as w,h as k,i as M,p as R,j as F,H,O as P}from"./app-c29ccfd3.js";import{P as $}from"./PrimaryButton-8b9535d3.js";import{H as O}from"./HeadRow-ac76cc75.js";import{_ as K}from"./Paginate-47414170.js";import{A as W}from"./AuthenticatedLayout-d57ac5a1.js";import{f as C}from"./helper-449b5e06.js";import"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                                */const q={class:"my-3 p-3 bg-body rounded shadow-sm"},z=["onSubmit"],G={class:"row mb-3"},Q={class:"col-md-3"},X={class:"form-floating mb-3"},Y=t("label",{for:"keywordInput"},"Keyword",-1),J={class:"col-md-3"},Z={class:"form-floating mb-3"},tt=t("label",{for:"startInput"},"Entry",-1),et={class:"col-md-3"},ot={class:"form-floating mb-3"},st=t("label",{for:"endInput"},"Exit",-1),lt={class:"col-md-3"},nt={class:"form-floating mb-3"},it=t("option",{value:null},"All",-1),at=["value"],dt=t("label",{for:"stationInput"},"Station",-1),rt={class:"col-md-3"},ct={class:"form-floating mb-3"},ut=t("option",{value:null},"All",-1),_t=t("option",{value:"yes"},"Yes",-1),mt=t("option",{value:"no"},"No",-1),ft=[ut,_t,mt],pt=t("label",{for:"stationInput"},"Overstay",-1),bt={class:"col-md-3"},ht={class:"form-floating mb-3"},yt=t("option",{value:null},"All",-1),vt=t("option",{value:"yes"},"With Exit Time",-1),xt=t("option",{value:"no"},"Without Exit Time",-1),gt=[yt,vt,xt],wt=t("label",{for:"stationInput"},"Exit Time",-1),kt={class:"col-12 d-flex justify-content-between"},Et=t("i",{class:"bi bi-search"},null,-1),It=t("i",{class:"bi bi-filetype-csv"},null,-1),St={class:"table table-bordered table-striped table-hover"},jt={width:"10%"},Ut=["onClick"],Vt=t("i",{class:"bi bi-trash"},null,-1),$t=[Vt],Mt={__name:"Index",props:{header:{type:Object},filters:{type:Object},list:{type:Object,default:()=>({})},station_list:{type:Object}},setup(u){const E=u;E.filters.is_export=0;const x="entrylogs",I=A("Entry Logs"),s=B(E.filters),T=n=>{s.sort.field=n,s.sort.direction=s.sort.direction==""||s.sort.direction=="desc"?"asc":"desc",j()};function S(n,o=""){return Object.keys(n).map(e=>{let i=n[e],d=o?`${o}[${e}]`:e;return i!==null&&typeof i=="object"?S(i,d):(i==null&&(i=""),`${d}=${encodeURIComponent(`${i}`.replace(/\s/g,"_"))}`)}).join("&")}const j=()=>{if(s.is_export){let n=S(s.data());H.get(route(x+".index")+"?"+n,{responseType:"blob"}).then(o=>{const e=o.headers["content-type"],i=o.headers["content-disposition"];let d="exportfile";if(i){const y=i.match(/filename="(.+)"/);y&&y.length===2&&(d=y[1])}const h=new Blob([o.data],{type:e,encoding:"UTF-8"}),_=document.createElement("a");_.href=window.URL.createObjectURL(h),_.download=d,_.click()})}else s.get(route(x+".index"),{preserveScroll:!0})},N=(n,o)=>{confirm(`Delete this entry ${o} ?`)&&P.delete(route(x+".destroy",n))},U=n=>{s.is_export=n};return(n,o)=>(r(),c(v,null,[m(l(D),{title:I.value},null,8,["title"]),m(W,null,{header:f(()=>[b(a(I.value),1)]),default:f(()=>[t("div",q,[t("form",{onSubmit:L(j,["prevent"])},[t("div",G,[t("div",Q,[t("div",X,[p(t("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>l(s).keyword=e),type:"text",class:"form-control",id:"keywordInput",placeholder:"Keyword",autocomplete:"off"},null,512),[[g,l(s).keyword]]),Y])]),t("div",J,[t("div",Z,[p(t("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>l(s).start=e),type:"date",class:"form-control",id:"startInput",placeholder:"Start",autocomplete:"off"},null,512),[[g,l(s).start]]),tt])]),t("div",et,[t("div",ot,[p(t("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>l(s).end=e),type:"date",class:"form-control",id:"endInput",placeholder:"End",autocomplete:"off"},null,512),[[g,l(s).end]]),st])]),t("div",lt,[t("div",nt,[p(t("select",{"onUpdate:modelValue":o[3]||(o[3]=e=>l(s).station_id=e),class:"form-select"},[it,(r(!0),c(v,null,k(u.station_list,e=>(r(),c("option",{value:e.id},a(e.name),9,at))),256))],512),[[w,l(s).station_id]]),dt])]),t("div",rt,[t("div",ct,[p(t("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>l(s).overstay=e),class:"form-select"},ft,512),[[w,l(s).overstay]]),pt])]),t("div",bt,[t("div",ht,[p(t("select",{"onUpdate:modelValue":o[5]||(o[5]=e=>l(s).exit_time=e),class:"form-select"},gt,512),[[w,l(s).exit_time]]),wt])]),t("div",kt,[m($,{type:"submit",disabled:l(s).processing,onClick:o[6]||(o[6]=e=>U(0))},{default:f(()=>[Et,b(" Search ")]),_:1},8,["disabled"]),m($,{type:"submit",disabled:l(s).processing,onClick:o[7]||(o[7]=e=>U(1))},{default:f(()=>[It,b(" Export ")]),_:1},8,["disabled"])])])],40,z),t("table",St,[t("thead",null,[t("tr",null,[m(O,null,{default:f(()=>[b("Actions")]),_:1}),(r(!0),c(v,null,k(u.header,e=>(r(),M(O,{field:e.field,sort:e.sortable?u.filters.sort:null,onSortEvent:T,disabled:l(s).processing},{default:f(()=>[b(a(e.title),1)]),_:2},1032,["field","sort","disabled"]))),256))])]),t("tbody",null,[(r(!0),c(v,null,k(u.list.data,(e,i)=>{var d,h,_;return r(),c("tr",null,[t("td",jt,[e.can_delete_entry?(r(),c("button",{key:0,onClick:y=>{var V;return N(e.id,(V=e.employee)==null?void 0:V.card_id)},class:"btn btn-sm btn-link"},$t,8,Ut)):R("",!0)]),t("td",null,a((d=e.employee)==null?void 0:d.staff_no),1),t("td",null,a((h=e.employee)==null?void 0:h.name),1),t("td",null,a((_=e.station)==null?void 0:_.name),1),t("td",null,a(l(C)(e.enter_time)),1),t("td",null,a(l(C)(e.exit_time)),1),t("td",{class:F(e.overstay_seconds>0?"text-danger":"")},a(e.stay_label),3)])}),256))])]),m(K,{data:u.list},null,8,["data"])])]),_:1})],64))}};export{Mt as default};
